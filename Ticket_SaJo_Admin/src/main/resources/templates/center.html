<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

<script src="https://code.highcharts.com/highcharts.js"></script>
<script src="https://code.highcharts.com/modules/series-label.js"></script>
<script src="https://code.highcharts.com/modules/exporting.js"></script>
<script src="https://code.highcharts.com/modules/export-data.js"></script>
<script src="https://code.highcharts.com/modules/accessibility.js"></script>


<style>
.highcharts-figure,
.highcharts-data-table table {
    min-width: 310px;
    max-width: 800px;
    margin: 1em auto;
}

.highcharts-data-table table {
    font-family: Verdana, sans-serif;
    border-collapse: collapse;
    border: 1px solid #ebebeb;
    margin: 10px auto;
    text-align: center;
    width: 100%;
    max-width: 500px;
}

.highcharts-data-table caption {
    padding: 1em 0;
    font-size: 1.2em;
    color: #555;
}

.highcharts-data-table th {
    font-weight: 600;
    padding: 0.5em;
}

.highcharts-data-table td,
.highcharts-data-table th,
.highcharts-data-table caption {
    padding: 0.5em;
}

.highcharts-data-table thead tr,
.highcharts-data-table tr:nth-child(even) {
    background: #f8f8f8;
}

.highcharts-data-table tr:hover {
    background: #f1f7ff;
}

</style>

</head>
<body>
	<div class="main-panel">
		<div class="content-wrapper">
			<div class="row">
				<div class="col-md-12 grid-margin">
					<div class="row">
						<div class="col-12 col-xl-8 mb-4 mb-xl-0">
							<h3 class="font-weight-bold">
								<span th:text="${session.loginadmin.id}"> </span>님.
							</h3>
							<h6 class="font-weight-normal mb-0">
								<span class="text-primary">관리자 페이지에 방문하신것을 환영합니다!</span>
							</h6>
						</div>
						<div class="col-12 col-xl-4">
							<div class="justify-content-end d-flex">
								<!-- 								<div class="dropdown flex-md-grow-1 flex-xl-grow-0">
									<button class="btn btn-sm btn-light bg-white dropdown-toggle"
										type="button" id="dropdownMenuDate2" data-toggle="dropdown"
										aria-haspopup="true" aria-expanded="true">
										<i class="mdi mdi-calendar"></i> Today (10 Jan 2021)
									</button>
									<div class="dropdown-menu dropdown-menu-right"
										aria-labelledby="dropdownMenuDate2">
										<a class="dropdown-item" href="#">January - March</a> <a
											class="dropdown-item" href="#">March - June</a> <a
											class="dropdown-item" href="#">June - August</a> <a
											class="dropdown-item" href="#">August - November</a>
									</div>
								</div> -->
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="col-md-6 grid-margin stretch-card">
					<div class="card tale-bg">
						<div class="card-people mt-auto">
							<figure class="highcharts-figure">
								<div id="visitchart"></div>

							</figure>
						</div>
					</div>
				</div>
				<div class="col-md-6 grid-margin transparent">
					<div class="row">
						<div class="col-md-6 mb-4 stretch-card transparent">
							<div class="card card-tale">
								<div class="card-body">
									<p class="mb-5">Today's 방문자 수</p>
									<p class="fs-30 mb-2 text-center" th:text="${today_visit}+' 명'">0</p>
									<!-- <p>10.00% (30 days)</p> -->
								</div>
							</div>
						</div>
						<div class="col-md-6 mb-4 stretch-card transparent">
							<div class="card card-dark-blue">
								<div class="card-body">
									<p class="mb-4">오늘 상영할 영화</p>
									<p class="fs-30 mb-3 text-center"
										th:text="${today_movie_cnt}+' 편'">0</p>
									<p class="text-center"
										th:text="'( 내일 상영할 영화 '+${tomorrow_movie_cnt}+' 편 )'">0</p>
								</div>
							</div>
						</div>
					</div>
					<div class="row">
						<div class="col-md-6 mb-4 mb-lg-0 stretch-card transparent">
							<div class="card card-light-blue">
								<div class="card-body">
									<p class="mb-4">누적 회원 수</p>
									<p class="fs-30 mb-3 text-center" th:text="${custCnt}+' 명'">0</p>
									<p class="text-center"
										th:text="'( 탈퇴 회원 수 '+${custExitCnt}+' 명 )'">0</p>
								</div>
							</div>
						</div>
						<div class="col-md-6 stretch-card transparent">
							<div class="card card-light-danger">
								<div class="card-body">
									<p class="mb-5">당일 예약 수</p>
									<p class="fs-30 mb-2 text-center"
										th:text="${today_ticketBuy_cnt}+' 명'">0</p>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<!-- content-wrapper ends -->
		<!-- partial:partials/_footer.html -->
		<footer class="footer">
			<div
				class="d-sm-flex justify-content-center justify-content-sm-between">
				<span
					class="text-muted text-center text-sm-left d-block d-sm-inline-block">Copyright
					© 2021. Premium <a href="https://www.bootstrapdash.com/"
					target="_blank">Bootstrap admin template</a> from BootstrapDash.
					All rights reserved.
				</span> <span
					class="float-none float-sm-right d-block mt-1 mt-sm-0 text-center">Hand-crafted
					& made with <i class="ti-heart text-danger ml-1"></i>
				</span>
			</div>
			<div
				class="d-sm-flex justify-content-center justify-content-sm-between">
				<span
					class="text-muted text-center text-sm-left d-block d-sm-inline-block">Distributed
					by <a href="https://www.themewagon.com/" target="_blank">Themewagon</a>
				</span>
			</div>
		</footer>
		<!-- partial -->
	</div>
	<script>
	$(document).ready(function() {
		getData();
		
		
	});
	
	function getData(){
		$.ajax({
			url:'visitChartimpl',
			//data:{'id':id},
			success:function(data){//JsonObject 형태에 JsonArray형식으로 visitcnt, data 가 들어가있음 
				visitChart(data);
				//alert(data);
			}
		});
		
	}
	
	function display(data){
		var title = $('#title').text();
		chart = Highcharts.chart('chartcontainer', {
			colors: ['#FAE0D4', '#E8D9FF', '#FFFF7E', '#FFFF7E', '#00D8FF'],
		    title: {
		        text: '연령별 영화 리뷰 수'
		    },
		    subtitle: {
		        text: title+'의 영화 리뷰'
		    },
		    xAxis: {
		        categories: data.age,
		       
		    },
		    yAxis: {
		    	 title : {
			        	text:'리뷰 수'
			        }
		    },
		    series: [{
		        type: 'column',
		        name : '수',
		        colorByPoint: true,
		        data: data.rcnt,
		        showInLegend: false
		    }]
		});
		
	};
	
	function visitChart(data){
		Highcharts.chart('visitchart', {
 		    chart: {
		        type: 'spline',
		        scrollablePlotArea: {
		            minWidth: 300,
		            scrollPositionX: 1
		        }
		    },
		    title: {
		        text: '최근 7일간 방문자수 통계 ',
		        align: 'center'
		    },
		    subtitle: {
		        text: '',
		        align: 'left'
		    },
		    xAxis: {
 		        type: 'date',
		        labels: {
		            overflow: 'justify'
		        },
		        categories: data.date
		    },
		    yAxis: {
		        title: {
		            text: '방문자 수 '
		        },
		        minorGridLineWidth: 0,
		        gridLineWidth: 0,
		        alternateGridColor: null,
		        plotBands: [{ // Light air
		            from: 0,// y축 나눌 범위. 0.3~ 1.5까지는 "방문자수 낮음" 으로 표시 
		            to: 30,
		            color: 'rgba(68, 170, 213, 0.1)',
		            label: {
		                text: '방문자수 낮음 ',
		                style: {
		                    color: '#606060'
		                }
		            }
		        }, { // Light breeze
		            from: 30,
		            to: 60,
		            color: 'rgba(0, 0, 0, 0)',
		            label: {
		                text: '방문자수 약간 낮음 ',
		                style: {
		                    color: '#606060'
		                }
		            }
		        }, { // Gentle breeze
		            from: 60,
		            to: 90,
		            color: 'rgba(68, 170, 213, 0.1)',
		            label: {
		                text: '방문자수 평균',
		                style: {
		                    color: '#606060'
		                }
		            }
		        }, { // Moderate breeze
		            from: 90,
		            to: 140,
		            color: 'rgba(0, 0, 0, 0)',
		            label: {
		                text: '방문자수 많음',
		                style: {
		                    color: '#606060'
		                }
		            }
		        }, { // Fresh breeze
		            from: 140,
		            to: 170,
		            color: 'rgba(68, 170, 213, 0.1)',
		            label: {
		                text: '방문자수 아주 많음 ',
		                style: {
		                    color: '#606060'
		                }
		            }
		        }, { // Strong breeze
		            from: 170,
		            to: 1000,
		            color: 'rgba(0, 0, 0, 0)',
		            label: {
		                text: '방문자수 포화 많음 ',
		                style: {
		                    color: '#606060'
		                }
		            }
		        }]
		    },
		    tooltip: {
		        valueSuffix: ' 명'
		    },
		    plotOptions: {
		        spline: {
		            lineWidth: 4,// 그래프 굵기  
		            states: {
		                hover: {
		                    lineWidth: 5
		                }
		            },
		            marker: {
		                enabled: false
		            },
		            pointInterval: 1, // one hour -> x축 증가 범위 
		            pointStart: 0// 시작값 
		        }
		    },
		    series: [{
		        name: '전체 평균 방문자 수 ',
		        data: data.avg

		    }, {
		        name: '지난 7일간 날짜별 방문자 수 ',
		        data: data.visitcnt
		    }],
		    navigation: {
		        menuItemStyle: {
		            fontSize: '10px'
		        }
		    }
		});
	}


</script>
</body>
</html>